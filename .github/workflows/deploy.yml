name: Deploy to Dokploy

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Trigger Dokploy Deployment
        env:
          DOKPLOY_WEBHOOK_URL: ${{ secrets.DOKPLOY_WEBHOOK_URL }}
        run: |
          if [ -n "$DOKPLOY_WEBHOOK_URL" ]; then
            curl -X POST "$DOKPLOY_WEBHOOK_URL"
            echo "âœ… Deployment triggered successfully"
          else
            echo "âš ï¸  DOKPLOY_WEBHOOK_URL not set in secrets"
            echo "Please add it in: Settings â†’ Secrets â†’ Actions"
          fi

      - name: Notify Deployment
        run: |
          echo "ğŸš€ Deployment initiated for SmarterBOT.store"
          echo "ğŸ“¦ Commit: ${{ github.sha }}"
          echo "ğŸ‘¤ Author: ${{ github.actor }}"
          echo "ğŸ“ Message: ${{ github.event.head_commit.message }}"
